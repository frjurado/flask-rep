{% extends 'layout.html' %}

{% block content %}

<h2 class="post-title">
  {{ post.name }}
</h2>

<div class="post-head">
  <a href="{{ url_for('main.author', username=post.author.username) }}">
    <img src="{{ post.author.gravatar(32) }}" alt="{{ post.author.name or post.author.username }}">
  </a>
  - {{ post.created }}
  {% if post.category %}
  <br>
  {{ post.category.tree() }}
  {% endif %}
</div>

<div>
  {% for tag in post.tags %}
  <span class="label label-primary">
    {{ tag.link(classes="link-unstyled") }}
  </span>
  {% endfor %}
</div>

<div class="post-body">
{% if post.body_html %}
  {{ post.body_html | safe }}
{% else %}
  {{ post.body_md }}
{% endif %}
</div>

{% if post.author == current_user or current_user.can(Permission.EDIT_POST) %}
<div>
  {{ post.edit_link() }}
  {{ post.delete_form() }}
</div>
{% endif %}

{% endblock %}
